<div class="result-component">
  <div fxLayout="row" style="margin-bottom: 20px" >
    <button mat-fab color="white" style="margin-right: 10px" [routerLink]="'/'">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <mat-card class="search-comp" fxFlex="1 0 80%">  
      <app-search [searchQuery]="query"></app-search>
    </mat-card>
  </div>
  <div fxLayout="row" class="filter-row" fxLayoutAlign="space-between">
    <div class="information mat-title">
      Category: {{this.category || "any"}}
    </div>
    <button mat-raised-button color="primary" disableRipple="true" [matMenuTriggerFor]="menuFilter">
      Filter
    </button>
  </div>
  <mat-menu #menuFilter="matMenu" panelClass="filter-menu">
    <div fxLayout="row wrap">
      <div class="filter-categories mat-title" fxFlex="1 0 40%" (click)="$event.stopPropagation()">
        Region
      </div>
      <div style="padding: 10px;">
        <button mat-stroked-button color="secondary" disableRipple="true" fxFlex="1 0 20%" (click)="clearRegions($event)">
          Clear filters
        </button>
      </div>
    </div>
    <div fxLayout="row wrap" class="filter-checkboxes">
      <mat-checkbox [(ngModel)]="region.checked" *ngFor="let region of regions" (click)="$event.stopPropagation()"
        fxFlex="1 0 50%" style="padding: 10px">
        {{region.name}}
      </mat-checkbox>
    </div>
    <div fxLayout="row wrap">
      <div class="filter-categories mat-title" fxFlex="1 0 40%" (click)="$event.stopPropagation()">
        City
      </div>
      <div style="padding: 10px;">
        <button mat-stroked-button color="secondary" disableRipple="true" fxFlex="1 0 20%" (click)="clearCities($event)">
          Clear filters
        </button>
      </div>
    </div>
    <div fxLayout="row wrap" class="filter-checkboxes">
      <mat-checkbox [(ngModel)]="city.checked" *ngFor="let city of cities" (click)="$event.stopPropagation()"
        fxFlex="1 0 33%" style="padding: 10px">
        {{city.name}}
      </mat-checkbox>
    </div>
    <div fxLayout="row wrap" fxLayoutAlign="space-between" style="padding: 10px">
      <button mat-raised-button color="primary" disableRipple="true" fxFlex="1 0 40%" (click)="fetchOffers()">
        Apply
      </button>
      <button mat-raised-button color="secondary" disableRipple="true" fxFlex="1 0 40%">
        Cancel
      </button>
    </div>
  </mat-menu>
  <div fxLayout="row" fxLayoutAlign="center" *ngIf="loading">
    <mat-progress-spinner mode="indeterminate" diameter="100"></mat-progress-spinner>
  </div>

  <div *ngIf="count === 0 && !loading">
    <div class="no-results mat-title">
      No results available for your query!
    </div>
  </div>
  <mat-card class="result-card" *ngFor="let offer of offers | paginate: {
      itemsPerPage: pageSize,
          currentPage: page,
          totalItems: count
    };" [routerLink]="'/offers/' + offer.id">
    <div fxLayout="row">
      <div fxLayout="column" class="img-col">
        <img [src]="offer.pictures[0].image" />
      </div>

      <div fxLayout="column" fxLayoutAlign="space-between" class="content-col">
        <div fxLayout="row" fxLayoutAlign="space-between">
          <div fxLayout="column">{{ offer.name }}</div>
          <div fxLayout="column">{{ offer.address }}, {{offer.city}}</div>
        </div>

        <div fxLayout="row" style="padding: 15px 0px">
          <div>{{ offer.category }}</div>
        </div>

        <div fxLayout="row">
          {{ offer.description }}
        </div>
      </div>
    </div>
  </mat-card>
  <div *ngIf="count != 0 && !loading" class="pagination-control-div" fxLayout="row" fxFlexAlign="center">
    <pagination-controls class="pagination-control" previousLabel="Prev" nextLabel="Next" responsive="true"
      (pageChange)="handlePageChange($event)">
    </pagination-controls>
  </div>
</div>